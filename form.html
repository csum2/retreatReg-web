<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Retreat Registration Form</title>
    <link rel="stylesheet" href="/style.css"> <!-- Link to external CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
    <button class="logout-btn" id="logoutBtn" style="width: auto;">&#10006;</button>
    <div class="container">
        <h2>Retreat Registration Form</h2>
        <p id="eventInfo1">
            Please note that no matter how many persons (up to four) stay in the unit, you will pay the resident a fixed fee of $999. Besides, each person has to pay for a meal plan of $200. The meal plan includes two meals per day for two days. There are no partial meal plans available.
        </p>
        
        <label for="familyCount">Number of families in the unit:</label>
        <select id="numFamilies">
            <option value="1">1</option>
            <option value="2">2</option>
        </select>

        <h3>Room 1</h3>
        <input type="text" id="name1" placeholder="Name 1" required>
        <input type="text" id="name2" placeholder="Name 2">

        <h3>Room 2</h3>
        <input type="text" id="name3" placeholder="Name 3">
        <input type="text" id="name4" placeholder="Name 4">

        <hr class="divider">

        <label>T-shirt Order details:</label>
        <p id="eventInfo2">
            The price for each T-shirt is $20. Please select the color, size, and quantity.
        </p>
        
        <table id="tshirtOrderTable">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Color</th>
                    <th>Size</th>
                    <th>Qty</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td>
                        <select class="colorSelect">
                            <option value="Black" selected>Black</option>
                            <option value="White">White</option>
                            <option value="Yellow">Yellow</option>
                            <option value="Red">Red</option>
                        </select>
                    </td>
                    <td>
                        <select class="sizeSelect">
                            <option value="S" selected>S</option>
                            <option value="M">M</option>
                            <option value="L">L</option>
                            <option value="XL">XL</option>
                        </select>
                    </td>
                    <td>
                        <select class="qtySelect">
                            <option value="0" selected>0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                        </select>
                    </td>
                </tr>
                <!-- Repeat for rows 2, 3, and 4 as needed -->
                <tr>
                    <td>2</td>
                    <td>
                        <select class="colorSelect">
                            <option value="Black" selected>Black</option>
                            <option value="White">White</option>
                            <option value="Yellow">Yellow</option>
                            <option value="Red">Red</option>
                        </select>
                    </td>
                    <td>
                        <select class="sizeSelect">
                            <option value="S" selected>S</option>
                            <option value="M">M</option>
                            <option value="L">L</option>
                            <option value="XL">XL</option>
                        </select>
                    </td>
                    <td>
                        <select class="qtySelect">
                            <option value="0" selected>0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>
                        <select class="colorSelect">
                            <option value="Black" selected>Black</option>
                            <option value="White">White</option>
                            <option value="Yellow">Yellow</option>
                            <option value="Red">Red</option>
                        </select>
                    </td>
                    <td>
                        <select class="sizeSelect">
                            <option value="S" selected>S</option>
                            <option value="M">M</option>
                            <option value="L">L</option>
                            <option value="XL">XL</option>
                        </select>
                    </td>
                    <td>
                        <select class="qtySelect">
                            <option value="0" selected>0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>
                        <select class="colorSelect">
                            <option value="Black" selected>Black</option>
                            <option value="White">White</option>
                            <option value="Yellow">Yellow</option>
                            <option value="Red">Red</option>
                        </select>
                    </td>
                    <td>
                        <select class="sizeSelect">
                            <option value="S" selected>S</option>
                            <option value="M">M</option>
                            <option value="L">L</option>
                            <option value="XL">XL</option>
                        </select>
                    </td>
                    <td>
                        <select class="qtySelect">
                            <option value="0" selected>0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                        </select>
                    </td>
                </tr>

            </tbody>
        </table>

        <p style="display: flex; justify-content: space-between; align-items: center;">
            <span id="totalFee">Total Fee: $0.00</span>
            <button id="calculateFee" style="width: auto;">Calculate</button>
        </p>

        <button id="clearInput">Clear</button>
        <button id="submitForm" disabled>Submit</button>
    </div>

    <script>
        const numFamiliesSelect = document.getElementById('numFamilies');
        const nameInputs = [document.getElementById('name1'), document.getElementById('name2'), document.getElementById('name3'), document.getElementById('name4')];
        const submitButton = document.getElementById('submitForm');
        const qtySelects = document.querySelectorAll('.qtySelect');

        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('registrationForm');

            function updateNameFields() {
                const numFamilies = parseInt(numFamiliesSelect.value);
                nameInputs[0].required = true;
                nameInputs[1].required = false;
                nameInputs[2].required = (numFamilies === 2);
                nameInputs[3].required = false;
            }

            numFamiliesSelect.addEventListener('change', updateNameFields);

            form.addEventListener('submit', function(event) {
                if (!nameInputs[0].checkValidity() || (numFamiliesSelect.value == '2' && !nameInputs[2].checkValidity())) {
                    event.preventDefault();
                    alert('Please fill in the required fields.');
                }
            });

            // Initialize the form on page load
            updateNameFields();
        });
        
        // Function to calculate total fee
        function calculateTotalFee() {
            let total = 0;
            qtySelects.forEach(select => {
                const qty = parseInt(select.value);
                total += qty * 20; // Each T-shirt costs $20
            });

            document.getElementById('totalFee').textContent = `Total Fee: $${total.toFixed(2)}`;
            submitButton.disabled = total === 0;
        }

        document.getElementById('calculateFee').addEventListener('click', calculateTotalFee);

        // Clear form
        document.getElementById('clearInput').addEventListener('click', () => {
            // Clear name inputs
            nameInputs.forEach(input => {
                input.value = ''; // Clear the input value
            });

            // Reset family count to default
            numFamiliesSelect.selectedIndex = 0; // Reset to the first option (1 family)

            // Reset select elements
            document.querySelectorAll('.colorSelect, .sizeSelect, .qtySelect').forEach(select => {
                select.selectedIndex = 0; // Reset to the first option
            });

            // Reset total fee
            document.getElementById('totalFee').textContent = 'Total Fee: $0.00';

            // Disable the submit button
            submitButton.disabled = true;

            // Re-initialize the name fields based on the reset number of families
            updateNameFields();
        });

        document.getElementById('submitForm').addEventListener('click', () => {
            Swal.fire({
                icon: 'success',
                title: 'Order Submitted',
                text: 'Your order has been submitted successfully.',
                confirmButtonText: 'OK'
            });
        });

        document.getElementById('logoutBtn').addEventListener('click', () => {
            localStorage.removeItem('loginTimestamp');
            localStorage.removeItem('isLoggedIn');
            localStorage.removeItem('userData');
            window.location.href = 'index.html';
        });
    </script>
</body>
</html>
